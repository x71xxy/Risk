{% extends "base.html" %} {% block title %}设置双因素认证{% endblock %} {% block
content %}
<div class="auth-container">
  <div class="auth-box">
    <div class="auth-header">
      <h1>设置双因素认证</h1>
      <p class="subtitle">使用 Google Authenticator 扫描二维码</p>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, message in messages %}
    <div class="alert alert-{{ category }}">{{ message }}</div>
    {% endfor %} {% endif %} {% endwith %}

    <div class="qr-container">
      <img src="{{ qr_code }}" alt="2FA QR Code" />
      <p class="backup-code">备用密钥: {{ secret }}</p>
    </div>

    <form method="POST" class="auth-form">
      {{ form.hidden_tag() }}

      <div class="form-group">
        {{ form.token.label }} {{ form.token(class="form-control",
        placeholder="输入6位验证码") }} {% if form.token.errors %} {% for error
        in form.token.errors %}
        <span class="error-message">{{ error }}</span>
        {% endfor %} {% endif %}
      </div>

      {{ form.submit(class="btn btn-primary") }}
    </form>
  </div>
</div>

<style>
  .qr-container {
    text-align: center;
    margin: 2rem 0;
  }

  .qr-container img {
    max-width: 200px;
    margin-bottom: 1rem;
  }

  .backup-code {
    font-family: monospace;
    background: #f1f5f9;
    padding: 0.5rem;
    border-radius: 4px;
  }
</style>
{% endblock %}
